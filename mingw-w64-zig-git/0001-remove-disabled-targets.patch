From 10253380362ac484ff58e13392f7cb4d6f582d1d Mon Sep 17 00:00:00 2001
From: MSYS2 Continuous Integration <ci@msys2.org>
Date: Sat, 16 Oct 2021 23:32:23 -0700
Subject: [PATCH] remove disabled targets

---
 build.zig                     | 29 ---------------------
 cmake/Findllvm.cmake          | 35 -------------------------
 src/codegen/llvm.zig          | 48 +++++------------------------------
 src/codegen/llvm/bindings.zig | 29 ---------------------
 4 files changed, 6 insertions(+), 135 deletions(-)

diff --git a/build.zig b/build.zig
index 1bb4a159e..42a5e7c99 100644
--- a/build.zig
+++ b/build.zig
@@ -903,10 +903,6 @@ const llvm_libs = [_][]const u8{
     "LLVMDlltoolDriver",
     "LLVMCoverage",
     "LLVMLineEditor",
-    "LLVMXCoreDisassembler",
-    "LLVMXCoreCodeGen",
-    "LLVMXCoreDesc",
-    "LLVMXCoreInfo",
     "LLVMX86Disassembler",
     "LLVMX86AsmParser",
     "LLVMX86CodeGen",
@@ -918,26 +914,11 @@ const llvm_libs = [_][]const u8{
     "LLVMWebAssemblyDesc",
     "LLVMWebAssemblyUtils",
     "LLVMWebAssemblyInfo",
-    "LLVMSystemZDisassembler",
-    "LLVMSystemZAsmParser",
-    "LLVMSystemZCodeGen",
-    "LLVMSystemZDesc",
-    "LLVMSystemZInfo",
-    "LLVMSparcDisassembler",
-    "LLVMSparcAsmParser",
-    "LLVMSparcCodeGen",
-    "LLVMSparcDesc",
-    "LLVMSparcInfo",
     "LLVMRISCVDisassembler",
     "LLVMRISCVAsmParser",
     "LLVMRISCVCodeGen",
     "LLVMRISCVDesc",
     "LLVMRISCVInfo",
-    "LLVMPowerPCDisassembler",
-    "LLVMPowerPCAsmParser",
-    "LLVMPowerPCCodeGen",
-    "LLVMPowerPCDesc",
-    "LLVMPowerPCInfo",
     "LLVMNVPTXCodeGen",
     "LLVMNVPTXDesc",
     "LLVMNVPTXInfo",
@@ -951,16 +932,6 @@ const llvm_libs = [_][]const u8{
     "LLVMMipsCodeGen",
     "LLVMMipsDesc",
     "LLVMMipsInfo",
-    "LLVMLanaiDisassembler",
-    "LLVMLanaiCodeGen",
-    "LLVMLanaiAsmParser",
-    "LLVMLanaiDesc",
-    "LLVMLanaiInfo",
-    "LLVMHexagonDisassembler",
-    "LLVMHexagonCodeGen",
-    "LLVMHexagonAsmParser",
-    "LLVMHexagonDesc",
-    "LLVMHexagonInfo",
     "LLVMBPFDisassembler",
     "LLVMBPFAsmParser",
     "LLVMBPFCodeGen",
diff --git a/cmake/Findllvm.cmake b/cmake/Findllvm.cmake
index 47947b4a8..933bb7b07 100644
--- a/cmake/Findllvm.cmake
+++ b/cmake/Findllvm.cmake
@@ -115,18 +115,12 @@ elseif(ZIG_USE_LLVM_CONFIG)
   NEED_TARGET("ARM")
   NEED_TARGET("AVR")
   NEED_TARGET("BPF")
-  NEED_TARGET("Hexagon")
-  NEED_TARGET("Lanai")
   NEED_TARGET("Mips")
   NEED_TARGET("MSP430")
   NEED_TARGET("NVPTX")
-  NEED_TARGET("PowerPC")
   NEED_TARGET("RISCV")
-  NEED_TARGET("Sparc")
-  NEED_TARGET("SystemZ")
   NEED_TARGET("WebAssembly")
   NEED_TARGET("X86")
-  NEED_TARGET("XCore")
 
   if(ZIG_STATIC_LLVM)
     execute_process(
@@ -206,10 +200,6 @@ else()
   FIND_AND_ADD_LLVM_LIB(LLVMDlltoolDriver)
   FIND_AND_ADD_LLVM_LIB(LLVMCoverage)
   FIND_AND_ADD_LLVM_LIB(LLVMLineEditor)
-  FIND_AND_ADD_LLVM_LIB(LLVMXCoreDisassembler)
-  FIND_AND_ADD_LLVM_LIB(LLVMXCoreCodeGen)
-  FIND_AND_ADD_LLVM_LIB(LLVMXCoreDesc)
-  FIND_AND_ADD_LLVM_LIB(LLVMXCoreInfo)
   FIND_AND_ADD_LLVM_LIB(LLVMX86Disassembler)
   FIND_AND_ADD_LLVM_LIB(LLVMX86AsmParser)
   FIND_AND_ADD_LLVM_LIB(LLVMX86CodeGen)
@@ -221,26 +211,11 @@ else()
   FIND_AND_ADD_LLVM_LIB(LLVMWebAssemblyDesc)
   FIND_AND_ADD_LLVM_LIB(LLVMWebAssemblyUtils)
   FIND_AND_ADD_LLVM_LIB(LLVMWebAssemblyInfo)
-  FIND_AND_ADD_LLVM_LIB(LLVMSystemZDisassembler)
-  FIND_AND_ADD_LLVM_LIB(LLVMSystemZAsmParser)
-  FIND_AND_ADD_LLVM_LIB(LLVMSystemZCodeGen)
-  FIND_AND_ADD_LLVM_LIB(LLVMSystemZDesc)
-  FIND_AND_ADD_LLVM_LIB(LLVMSystemZInfo)
-  FIND_AND_ADD_LLVM_LIB(LLVMSparcDisassembler)
-  FIND_AND_ADD_LLVM_LIB(LLVMSparcAsmParser)
-  FIND_AND_ADD_LLVM_LIB(LLVMSparcCodeGen)
-  FIND_AND_ADD_LLVM_LIB(LLVMSparcDesc)
-  FIND_AND_ADD_LLVM_LIB(LLVMSparcInfo)
   FIND_AND_ADD_LLVM_LIB(LLVMRISCVDisassembler)
   FIND_AND_ADD_LLVM_LIB(LLVMRISCVAsmParser)
   FIND_AND_ADD_LLVM_LIB(LLVMRISCVCodeGen)
   FIND_AND_ADD_LLVM_LIB(LLVMRISCVDesc)
   FIND_AND_ADD_LLVM_LIB(LLVMRISCVInfo)
-  FIND_AND_ADD_LLVM_LIB(LLVMPowerPCDisassembler)
-  FIND_AND_ADD_LLVM_LIB(LLVMPowerPCAsmParser)
-  FIND_AND_ADD_LLVM_LIB(LLVMPowerPCCodeGen)
-  FIND_AND_ADD_LLVM_LIB(LLVMPowerPCDesc)
-  FIND_AND_ADD_LLVM_LIB(LLVMPowerPCInfo)
   FIND_AND_ADD_LLVM_LIB(LLVMNVPTXCodeGen)
   FIND_AND_ADD_LLVM_LIB(LLVMNVPTXDesc)
   FIND_AND_ADD_LLVM_LIB(LLVMNVPTXInfo)
@@ -254,16 +229,6 @@ else()
   FIND_AND_ADD_LLVM_LIB(LLVMMipsCodeGen)
   FIND_AND_ADD_LLVM_LIB(LLVMMipsDesc)
   FIND_AND_ADD_LLVM_LIB(LLVMMipsInfo)
-  FIND_AND_ADD_LLVM_LIB(LLVMLanaiDisassembler)
-  FIND_AND_ADD_LLVM_LIB(LLVMLanaiCodeGen)
-  FIND_AND_ADD_LLVM_LIB(LLVMLanaiAsmParser)
-  FIND_AND_ADD_LLVM_LIB(LLVMLanaiDesc)
-  FIND_AND_ADD_LLVM_LIB(LLVMLanaiInfo)
-  FIND_AND_ADD_LLVM_LIB(LLVMHexagonDisassembler)
-  FIND_AND_ADD_LLVM_LIB(LLVMHexagonCodeGen)
-  FIND_AND_ADD_LLVM_LIB(LLVMHexagonAsmParser)
-  FIND_AND_ADD_LLVM_LIB(LLVMHexagonDesc)
-  FIND_AND_ADD_LLVM_LIB(LLVMHexagonInfo)
   FIND_AND_ADD_LLVM_LIB(LLVMBPFDisassembler)
   FIND_AND_ADD_LLVM_LIB(LLVMBPFAsmParser)
   FIND_AND_ADD_LLVM_LIB(LLVMBPFCodeGen)
diff --git a/src/codegen/llvm.zig b/src/codegen/llvm.zig
index 4349fce4d..bab017592 100644
--- a/src/codegen/llvm.zig
+++ b/src/codegen/llvm.zig
@@ -3401,20 +3401,8 @@ fn initializeLLVMTarget(arch: std.Target.Cpu.Arch) void {
             llvm.LLVMInitializeBPFAsmPrinter();
             llvm.LLVMInitializeBPFAsmParser();
         },
-        .hexagon => {
-            llvm.LLVMInitializeHexagonTarget();
-            llvm.LLVMInitializeHexagonTargetInfo();
-            llvm.LLVMInitializeHexagonTargetMC();
-            llvm.LLVMInitializeHexagonAsmPrinter();
-            llvm.LLVMInitializeHexagonAsmParser();
-        },
-        .lanai => {
-            llvm.LLVMInitializeLanaiTarget();
-            llvm.LLVMInitializeLanaiTargetInfo();
-            llvm.LLVMInitializeLanaiTargetMC();
-            llvm.LLVMInitializeLanaiAsmPrinter();
-            llvm.LLVMInitializeLanaiAsmParser();
-        },
+        .hexagon => {},
+        .lanai => {},
         .mips, .mipsel, .mips64, .mips64el => {
             llvm.LLVMInitializeMipsTarget();
             llvm.LLVMInitializeMipsTargetInfo();
@@ -3436,13 +3424,7 @@ fn initializeLLVMTarget(arch: std.Target.Cpu.Arch) void {
             llvm.LLVMInitializeNVPTXAsmPrinter();
             // There is no LLVMInitializeNVPTXAsmParser function available.
         },
-        .powerpc, .powerpcle, .powerpc64, .powerpc64le => {
-            llvm.LLVMInitializePowerPCTarget();
-            llvm.LLVMInitializePowerPCTargetInfo();
-            llvm.LLVMInitializePowerPCTargetMC();
-            llvm.LLVMInitializePowerPCAsmPrinter();
-            llvm.LLVMInitializePowerPCAsmParser();
-        },
+        .powerpc, .powerpcle, .powerpc64, .powerpc64le => {},
         .riscv32, .riscv64 => {
             llvm.LLVMInitializeRISCVTarget();
             llvm.LLVMInitializeRISCVTargetInfo();
@@ -3450,20 +3432,8 @@ fn initializeLLVMTarget(arch: std.Target.Cpu.Arch) void {
             llvm.LLVMInitializeRISCVAsmPrinter();
             llvm.LLVMInitializeRISCVAsmParser();
         },
-        .sparc, .sparcv9, .sparcel => {
-            llvm.LLVMInitializeSparcTarget();
-            llvm.LLVMInitializeSparcTargetInfo();
-            llvm.LLVMInitializeSparcTargetMC();
-            llvm.LLVMInitializeSparcAsmPrinter();
-            llvm.LLVMInitializeSparcAsmParser();
-        },
-        .s390x => {
-            llvm.LLVMInitializeSystemZTarget();
-            llvm.LLVMInitializeSystemZTargetInfo();
-            llvm.LLVMInitializeSystemZTargetMC();
-            llvm.LLVMInitializeSystemZAsmPrinter();
-            llvm.LLVMInitializeSystemZAsmParser();
-        },
+        .sparc, .sparcv9, .sparcel => {},
+        .s390x => {},
         .wasm32, .wasm64 => {
             llvm.LLVMInitializeWebAssemblyTarget();
             llvm.LLVMInitializeWebAssemblyTargetInfo();
@@ -3478,13 +3448,7 @@ fn initializeLLVMTarget(arch: std.Target.Cpu.Arch) void {
             llvm.LLVMInitializeX86AsmPrinter();
             llvm.LLVMInitializeX86AsmParser();
         },
-        .xcore => {
-            llvm.LLVMInitializeXCoreTarget();
-            llvm.LLVMInitializeXCoreTargetInfo();
-            llvm.LLVMInitializeXCoreTargetMC();
-            llvm.LLVMInitializeXCoreAsmPrinter();
-            // There is no LLVMInitializeXCoreAsmParser function.
-        },
+        .xcore => {},
         .m68k => {
             if (build_options.llvm_has_m68k) {
                 llvm.LLVMInitializeM68kTarget();
diff --git a/src/codegen/llvm/bindings.zig b/src/codegen/llvm/bindings.zig
index 29a46a81e..471dfe09d 100644
--- a/src/codegen/llvm/bindings.zig
+++ b/src/codegen/llvm/bindings.zig
@@ -866,18 +866,12 @@ pub extern fn LLVMInitializeAMDGPUTargetInfo() void;
 pub extern fn LLVMInitializeARMTargetInfo() void;
 pub extern fn LLVMInitializeAVRTargetInfo() void;
 pub extern fn LLVMInitializeBPFTargetInfo() void;
-pub extern fn LLVMInitializeHexagonTargetInfo() void;
-pub extern fn LLVMInitializeLanaiTargetInfo() void;
 pub extern fn LLVMInitializeMipsTargetInfo() void;
 pub extern fn LLVMInitializeMSP430TargetInfo() void;
 pub extern fn LLVMInitializeNVPTXTargetInfo() void;
-pub extern fn LLVMInitializePowerPCTargetInfo() void;
 pub extern fn LLVMInitializeRISCVTargetInfo() void;
-pub extern fn LLVMInitializeSparcTargetInfo() void;
-pub extern fn LLVMInitializeSystemZTargetInfo() void;
 pub extern fn LLVMInitializeWebAssemblyTargetInfo() void;
 pub extern fn LLVMInitializeX86TargetInfo() void;
-pub extern fn LLVMInitializeXCoreTargetInfo() void;
 pub extern fn LLVMInitializeM68kTargetInfo() void;
 pub extern fn LLVMInitializeCSKYTargetInfo() void;
 pub extern fn LLVMInitializeVETargetInfo() void;
@@ -888,18 +882,12 @@ pub extern fn LLVMInitializeAMDGPUTarget() void;
 pub extern fn LLVMInitializeARMTarget() void;
 pub extern fn LLVMInitializeAVRTarget() void;
 pub extern fn LLVMInitializeBPFTarget() void;
-pub extern fn LLVMInitializeHexagonTarget() void;
-pub extern fn LLVMInitializeLanaiTarget() void;
 pub extern fn LLVMInitializeMipsTarget() void;
 pub extern fn LLVMInitializeMSP430Target() void;
 pub extern fn LLVMInitializeNVPTXTarget() void;
-pub extern fn LLVMInitializePowerPCTarget() void;
 pub extern fn LLVMInitializeRISCVTarget() void;
-pub extern fn LLVMInitializeSparcTarget() void;
-pub extern fn LLVMInitializeSystemZTarget() void;
 pub extern fn LLVMInitializeWebAssemblyTarget() void;
 pub extern fn LLVMInitializeX86Target() void;
-pub extern fn LLVMInitializeXCoreTarget() void;
 pub extern fn LLVMInitializeM68kTarget() void;
 pub extern fn LLVMInitializeVETarget() void;
 pub extern fn LLVMInitializeCSKYTarget() void;
@@ -910,18 +898,12 @@ pub extern fn LLVMInitializeAMDGPUTargetMC() void;
 pub extern fn LLVMInitializeARMTargetMC() void;
 pub extern fn LLVMInitializeAVRTargetMC() void;
 pub extern fn LLVMInitializeBPFTargetMC() void;
-pub extern fn LLVMInitializeHexagonTargetMC() void;
-pub extern fn LLVMInitializeLanaiTargetMC() void;
 pub extern fn LLVMInitializeMipsTargetMC() void;
 pub extern fn LLVMInitializeMSP430TargetMC() void;
 pub extern fn LLVMInitializeNVPTXTargetMC() void;
-pub extern fn LLVMInitializePowerPCTargetMC() void;
 pub extern fn LLVMInitializeRISCVTargetMC() void;
-pub extern fn LLVMInitializeSparcTargetMC() void;
-pub extern fn LLVMInitializeSystemZTargetMC() void;
 pub extern fn LLVMInitializeWebAssemblyTargetMC() void;
 pub extern fn LLVMInitializeX86TargetMC() void;
-pub extern fn LLVMInitializeXCoreTargetMC() void;
 pub extern fn LLVMInitializeM68kTargetMC() void;
 pub extern fn LLVMInitializeCSKYTargetMC() void;
 pub extern fn LLVMInitializeVETargetMC() void;
@@ -932,18 +914,12 @@ pub extern fn LLVMInitializeAMDGPUAsmPrinter() void;
 pub extern fn LLVMInitializeARMAsmPrinter() void;
 pub extern fn LLVMInitializeAVRAsmPrinter() void;
 pub extern fn LLVMInitializeBPFAsmPrinter() void;
-pub extern fn LLVMInitializeHexagonAsmPrinter() void;
-pub extern fn LLVMInitializeLanaiAsmPrinter() void;
 pub extern fn LLVMInitializeMipsAsmPrinter() void;
 pub extern fn LLVMInitializeMSP430AsmPrinter() void;
 pub extern fn LLVMInitializeNVPTXAsmPrinter() void;
-pub extern fn LLVMInitializePowerPCAsmPrinter() void;
 pub extern fn LLVMInitializeRISCVAsmPrinter() void;
-pub extern fn LLVMInitializeSparcAsmPrinter() void;
-pub extern fn LLVMInitializeSystemZAsmPrinter() void;
 pub extern fn LLVMInitializeWebAssemblyAsmPrinter() void;
 pub extern fn LLVMInitializeX86AsmPrinter() void;
-pub extern fn LLVMInitializeXCoreAsmPrinter() void;
 pub extern fn LLVMInitializeM68kAsmPrinter() void;
 pub extern fn LLVMInitializeVEAsmPrinter() void;
 pub extern fn LLVMInitializeARCAsmPrinter() void;
@@ -953,14 +929,9 @@ pub extern fn LLVMInitializeAMDGPUAsmParser() void;
 pub extern fn LLVMInitializeARMAsmParser() void;
 pub extern fn LLVMInitializeAVRAsmParser() void;
 pub extern fn LLVMInitializeBPFAsmParser() void;
-pub extern fn LLVMInitializeHexagonAsmParser() void;
-pub extern fn LLVMInitializeLanaiAsmParser() void;
 pub extern fn LLVMInitializeMipsAsmParser() void;
 pub extern fn LLVMInitializeMSP430AsmParser() void;
-pub extern fn LLVMInitializePowerPCAsmParser() void;
 pub extern fn LLVMInitializeRISCVAsmParser() void;
-pub extern fn LLVMInitializeSparcAsmParser() void;
-pub extern fn LLVMInitializeSystemZAsmParser() void;
 pub extern fn LLVMInitializeWebAssemblyAsmParser() void;
 pub extern fn LLVMInitializeX86AsmParser() void;
 pub extern fn LLVMInitializeM68kAsmParser() void;
-- 
2.33.0

